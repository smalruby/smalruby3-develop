---
paths:
  - "gui/smalruby3-gui/src/**/*.{js,jsx}"
  - "gui/smalruby3-gui/webpack.config.js"
---

# Google Drive統合

## CORS警告メッセージ

Google Driveファイル読み込み機能を使用する際、ブラウザコンソールに以下の警告が表示される場合があります：

```
Cross-Origin-Opener-Policy policy would block the window.opener call.
```

**この警告は無視して問題ありません。** 理由は以下の通りです：

## なぜ警告を無視できるのか

### 警告の発生源
- **Source**: この警告はGoogleの独自APIスクリプト（gapi）から発生
- GoogleのスクリプトがCOOPポリシーを検出してログに警告を出力している

### COOP Policy設定
- **既に設定済み**: webpack.config.js で `unsafe-none` に設定済み
- この設定により、最大限の互換性を確保
- `unsafe-none` 設定により `window.opener` 呼び出しが実際には動作する

### 機能は正常動作
警告が表示されていても、以下の機能は正常に動作します：
- Pickerダイアログの表示
- ファイル選択
- ファイルダウンロード
- プロジェクトの読み込み
- アップロードタブの機能

## 技術的詳細

### COOPポリシーの動作
1. Googleのスクリプトが実行時にCOOPポリシーを検出
2. ポリシーが設定されていることを警告としてログ出力
3. しかし、`unsafe-none` 設定により `window.opener` 呼び出しは実際には許可される
4. 警告は情報提供のみで、機能をブロックしない

### 警告抑制を試みない理由
- 警告を抑制しようとすると、Google Picker機能が壊れる可能性がある
- 現在の設定は、機能性と互換性のバランスが取れている
- Google側のスクリプトが出力する警告であり、アプリケーション側で制御できない

## 結論

Google Drive統合が正しく動作している場合、このCORS警告は期待される動作であり、開発環境・本番環境の両方で無視して問題ありません。

## 検証方法

Google Drive統合が正常に動作しているか確認する方法：

1. アプリケーションを起動
2. ファイルメニューから「Google Driveから読み込む」を選択
3. Google Pickerダイアログが表示されることを確認
4. ファイルを選択できることを確認
5. ファイルがダウンロード・読み込みされることを確認
6. ブラウザコンソールにCORS警告が表示されていても、上記が全て動作すればOK
